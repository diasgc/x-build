#!/bin/bash
# cpu av8 av7 x86 x64
# NDK PP+  .   .   .   clang
# GNU  .   .   .  PP++ gcc
# WIN  .   .   .   .   clang/gcc

lib='svtav1'
dsc='Scalable Video Technology for AV1 (SVT-AV1 Encoder and Decoder)'
lic='BSD-3c AOM-Patent'
src='https://gitlab.com/AOMediaCodec/SVT-AV1.git'
cfg='cmake'
pkg='SvtAv1Enc'
eta='145'
cmake_static='BUILD_STATIC_LIBS'
cmake_bin="BUILD_APPS"

dev_vrs='0.9.0'
lst_inc='svt-av1/*.h'
lst_lib='libSvtAv1Dec libSvtAv1Enc'
lst_bin='SvtAv1DecApp SvtAv1EncApp'
lst_lic='LICENSE.md LICENSE-BSD2.md PATENTS.md'
lst_pc='SvtAv1Enc.pc SvtAv1Dec.pc'

cmake_config="-DBUILD_TESTING=OFF"

. xbuild

$host_ndk && LDFLAGS+=" -L$SYSROOT/usr/${arch}/lib -llog"
WFLAGS='-Wno-unused-command-line-argument'

start

# patch 01-02 EbThreads.c and EbThreads.h to support android
# patch 03-04 support dual shared static builds and includes licence files
# do not edit below
<<'LZS_PATCH'
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
LZS_PATCH

# Filelist
# --------
# include/svt-av1/EbDebugMacros.h
# include/svt-av1/EbSvtAv1Formats.h
# include/svt-av1/EbSvtAv1ExtFrameBuf.h
# include/svt-av1/EbSvtAv1Enc.h
# include/svt-av1/EbSvtAv1ErrorCodes.h
# include/svt-av1/EbSvtAv1Metadata.h
# include/svt-av1/EbSvtAv1.h
# include/svt-av1/EbSvtAv1Dec.h
# lib/pkgconfig/SvtAv1Enc.pc
# lib/pkgconfig/SvtAv1Dec.pc
# lib/libSvtAv1Dec.so
# lib/libSvtAv1Enc.a
# lib/libSvtAv1Enc.so
# lib/libSvtAv1Dec.a
# share/docs/SvtAv1/README.md
# share/docs/SvtAv1/LICENSE-BSD2.md
# share/docs/SvtAv1/PATENTS.md
# share/docs/SvtAv1/LICENSE.md
# bin/SvtAv1DecApp
# bin/SvtAv1EncApp
