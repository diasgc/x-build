#!/bin/bash

lib='libdeflate'
apt='libdeflate-dev'
dsc='Fast, whole-buffer DEFLATE-based compression and decompression'
lic='MIT'
src="https://github.com/ebiggers/libdeflate.git"
sty='git'
cfg='cmake'
cmake_static='BUILD_STATIC_LIBS'
eta='10'

pc_llib='-ldeflate'

lst_inc='libdeflate.h'
lst_lib='libdeflate'
lst_bin='gzip'
lst_lic='COPYING'
lst_pc='libdeflate.pc'

. xbuilder.sh && start

# Patch 01: create CMakeLists.txt with dual static and shared build support
<<'XB64_PATCH'
LS0tIENNYWtlTGlzdHMudHh0CTIwMjItMDEtMjMgMjI6MTI6NTcuNjE1MzkwNjAwICswMDAwCisrKyBDTWFrZUxpc3
RzLnR4dAkyMDIyLTAxLTIzIDIyOjEyOjQzLjc3MTAwMDAwMCArMDAwMApAQCAtMCwwICsxLDgxIEBACitjbWFrZV9t
aW5pbXVtX3JlcXVpcmVkKFZFUlNJT04gMy4xMCkKKworcHJvamVjdChsaWJkZWZsYXRlIEMpCitvcHRpb24oQlVJTE
RfU1RBVElDX0xJQlMgIkJ1aWxkIHN0YXRpYyBsaWJzIiBPTikKK29wdGlvbihCVUlMRF9FWEVDVVRBQkxFUyAiQnVp
bGQgZXhlY3V0YWJsZXMiIE9OKQorb3B0aW9uKEJVSUxEX1RFU1RTICJCdWlsZCB0ZXN0cyIgQ01BS0VfT0JKQ1hYX0
VYVEVOU0lPTlMpCitvcHRpb24oRU5BQkxFX0NSQyAiZW5hYmxlIGNyYyIgT04pCitvcHRpb24oRU5BQkxFX0NSWVBU
TyAiZW5hYmxlIGNyeXB0byIgT04pCisKKyNvcHRpb24oSU5TVEFMTF9NQU4gIkluc3RhbGwgbWFuIiBPRkYpCisjb3
B0aW9uKElOU1RBTExfRE9DUyAiSW5zdGFsbCBkb2NzIiBPRkYpCisjYWRkX2NvbXBpbGVfb3B0aW9ucygiLVduby1z
aGlmdC1uZWdhdGl2ZS12YWx1ZSIpCisKK2ZpbmRfcGFja2FnZShaTElCKQoraW5jbHVkZV9kaXJlY3Rvcmllcygke0
NNQUtFX1NPVVJDRV9ESVJ9IGNvbW1vbiBsaWIgJHtaTElCX0lOQ0xVREVfRElSU30pCitmaWxlKEdMT0Igc3JjX2Rl
ZmxhdGUgbGliLyouYykKK2ZpbGUoR0xPQiBoZHJfZGVmbGF0ZSBsaWJkZWZsYXRlLmggbGliLyouaCkKKworaWYoJH
tDTUFLRV9TWVNURU1fUFJPQ0VTU09SfSBNQVRDSEVTICJeYXJtIikKKyAgZmlsZShHTE9CIHNyY19jcHUgbGliL2Fy
bS8qLmMpCisgIGZpbGUoR0xPQiBoZHJfY3B1IGxpYi9hcm0vKi5oKQorICBpZihFTkFCTEVfQ1JDKQorICAgIHNldC
hDTUFLRV9DX0ZMQUdTICIke0NNQUtFX0NfRkxBR1N9IC1tY3JjIikKKyAgZW5kaWYoKQorICAjaWYoRU5BQkxFX0NS
WVBUTykKKyAgIyAgc2V0KENNQUtFX0NfRkxBR1MgIiR7Q01BS0VfQ19GTEFHU30gLW1mcHU9Y3J5cHRvLW5lb24tZn
AtYXJtdjgiKQorICAjZW5kaWYoKQorZWxzZWlmKCR7Q01BS0VfU1lTVEVNX1BST0NFU1NPUn0gTUFUQ0hFUyAiXmEu
KjY0JCIpCisgIGZpbGUoR0xPQiBzcmNfY3B1IGxpYi9hcm0vKi5jKQorICBmaWxlKEdMT0IgaGRyX2NwdSBsaWIvYX
JtLyouaCkKKyAgaWYoRU5BQkxFX0NSQykKKyAgICBzZXQoQ01BS0VfQ19GTEFHUyAiJHtDTUFLRV9DX0ZMQUdTfSAt
bWFyY2g9YXJtdjgtYStjcmMiKQorICBlbmRpZigpCisgIGlmKEVOQUJMRV9DUllQVE8pCisgICAgc2V0KENNQUtFX0
NfRkxBR1MgIiR7Q01BS0VfQ19GTEFHU30gLW1hcmNoPWFybXY4LWErY3J5cHRvIikKKyAgZW5kaWYoKQorZWxzZSgp
CisgIGZpbGUoR0xPQiBzcmNfY3B1IGxpYi94ODYvKi5jKQorICBmaWxlKEdMT0IgaGRyX2NwdSBsaWIveDg2LyouaC
kKK2VuZGlmKCkKKworc2V0KGRlZmxhdGVfVGFyZ2V0cyBkZWZsYXRlKQorYWRkX2xpYnJhcnkoZGVmbGF0ZSAke3Ny
Y19kZWZsYXRlfSAke2hkcl9kZWZsYXRlfSAke3NyY19jcHV9ICR7aGRyX2NwdX0pCisKK2lmKEJVSUxEX1NIQVJFRF
9MSUJTIEFORCBCVUlMRF9TVEFUSUNfTElCUykKKyAgYWRkX2xpYnJhcnkoZGVmbGF0ZV9zdGF0aWMgU1RBVElDICR7
c3JjX2RlZmxhdGV9ICR7aGRyX2RlZmxhdGV9ICR7c3JjX2NwdX0gJHtoZHJfY3B1fSkKKyAgc2V0X3RhcmdldF9wcm
9wZXJ0aWVzKGRlZmxhdGVfc3RhdGljIFBST1BFUlRJRVMgT1VUUFVUX05BTUUgZGVmbGF0ZSkKKyAgc2V0KGRlZmxh
dGVfVGFyZ2V0cyBkZWZsYXRlIGRlZmxhdGVfc3RhdGljKQorZW5kaWYoKQorCitpZihCVUlMRF9FWEVDVVRBQkxFUy
kKKyAgYWRkX2V4ZWN1dGFibGUoZ3ppcCBwcm9ncmFtcy9nemlwLmMgcHJvZ3JhbXMvdGdldG9wdC5jIAorICAgIHBy
b2dyYW1zL3Rlc3RfdXRpbC5jIHByb2dyYW1zL3Rlc3RfdXRpbC5oCisgICAgcHJvZ3JhbXMvcHJvZ191dGlsLmMgcH
JvZ3JhbXMvcHJvZ191dGlsLmgKKyAgICApCisgIHRhcmdldF9saW5rX2xpYnJhcmllcyhnemlwIGRlZmxhdGUgJHta
TElCX0xJQlJBUklFU30pCitlbmRpZigpCisKK2lmKEJVSUxEX1RFU1RTKQorICBhZGRfZXhlY3V0YWJsZShiZW5jaG
1hcmsgcHJvZ3JhbXMvYmVuY2htYXJrLmMgcHJvZ3JhbXMvdGdldG9wdC5jCisgICAgcHJvZ3JhbXMvdGVzdF91dGls
LmMgcHJvZ3JhbXMvdGVzdF91dGlsLmgKKyAgICBwcm9ncmFtcy9jaGVja3N1bS5jIHByb2dyYW1zL3Rlc3RfY2hlY2
tzdW1zLmMgcHJvZ3JhbXMvdGVzdF9jdXN0b21fbWFsbG9jLmMgcHJvZ3JhbXMvdGVzdF9pbmNvbXBsZXRlX2NvZGVz
LmMKKyAgICBwcm9ncmFtcy90ZXN0X2xpdHJ1bmxlbl9vdmVyZmxvdy5jIHByb2dyYW1zL3Rlc3Rfc2xvd19kZWNvbX
ByZXNzaW9uLmMgcHJvZ3JhbXMvdGVzdF90cmFpbGluZ19ieXRlcy5jCisgICAgKQorICB0YXJnZXRfbGlua19saWJy
YXJpZXMoYmVuY2htYXJrIGRlZmxhdGUgJHtaTElCX0xJQlJBUklFU30pCitlbmRpZigpCisKK2luc3RhbGwoVEFSR0
VUUyAke2RlZmxhdGVfVGFyZ2V0c30KKyAgUlVOVElNRSBERVNUSU5BVElPTiBiaW4KKyAgQVJDSElWRSBERVNUSU5B
VElPTiBsaWIke0xJQl9TVUZGSVh9CisgIExJQlJBUlkgREVTVElOQVRJT04gbGliJHtMSUJfU1VGRklYfSkKKworaW
5zdGFsbChGSUxFUyBsaWJkZWZsYXRlLmggREVTVElOQVRJT04gaW5jbHVkZSkKKworaWYoQlVJTERfRVhFQ1VUQUJM
RVMpCisgIGluc3RhbGwoVEFSR0VUUyBnemlwIFJVTlRJTUUgREVTVElOQVRJT04gYmluKQorZW5kaWYoKQorCitpZi
hCVUlMRF9URVNUUykKKyAgaW5zdGFsbChUQVJHRVRTIGJlbmNobWFyayBSVU5USU1FIERFU1RJTkFUSU9OIGJpbikK
K2VuZGlmKCkK
XB64_PATCH

# cpu av8 av7 x86 x64
# NDK +++  .   .   .  clang
# GNU  .   .   .   .  gcc
# WIN  .   .   .   .  clang/gcc


# Filelist
# --------
# include/libdeflate.h
# lib/pkgconfig/libdeflate.pc
# lib/libdeflate.so
# lib/libdeflate.a
# share/doc/libdeflate/COPYING
# bin/gzip
