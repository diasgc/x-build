#!/bin/bash

lib='libgsm'
apt='libgsm1-dev'
dsc='GSM 06.10 lossy speech compression'
lic='LGPL-2.1'
vrs='1.0.19'
src="http://www.quut.com/gsm/gsm-${vrs}.tar.gz"
cfg='cmake'
eta='60'
pc_llib="-lgsm"

cmake_static='BUILD_STATIC_LIBS'
cmake_bin='BUILD_TOOLS'

dev_bra=''
dev_vrs=''
stb_bra=''
stb_vrs=''

lst_inc='gsm.h'
lst_lib='libgsm'
lst_bin='toast untoast tcat'
lst_lic='COPYRIGHT'
lst_pc='libgsm.pc'

. xbuilder.sh

LD=${CC}

start

# patch-01: create CMakeLists.txt with dual static shared build support
# added options: BUILD_STATIC_LIBS(ON) BUILD_TOOLS(ON) BUILD_TESTS(OFF) INSTALL_MAN(OFF)
<<'XB64_PATCH'
LS0tIENNYWtlTGlzdHMudHh0CTIwMjItMDEtMjggMTg6MTk6MDEuOTMxNzkyMDAwICswMDAwCisr
KyBDTWFrZUxpc3RzLnR4dAkyMDIyLTAxLTI4IDE4OjE3OjA3Ljc3MTc5MjAwMCArMDAwMApAQCAt
MCwwICsxLDcyIEBACitjbWFrZV9taW5pbXVtX3JlcXVpcmVkKFZFUlNJT04gMi44LjEyKQorCitw
cm9qZWN0KGdzbSBDKQorCitvcHRpb24oQlVJTERfU1RBVElDX0xJQlMgIkJ1aWxkIHN0YXRpYyBs
aWJzIiBPTikKK29wdGlvbihCVUlMRF9UT09MUyAiQnVpbGQgdG9vbHMiIE9OKQorb3B0aW9uKEJV
SUxEX1RFU1RTICJCdWlsZCB0ZXN0cyIgT0ZGKQorb3B0aW9uKElOU1RBTExfTUFOICJJbnN0YWxs
IG1hbiIgT0ZGKQorCitpZiAoTk9UIEJVSUxEX1NIQVJFRF9MSUJTIEFORCBOT1QgQlVJTERfU1RB
VElDX0xJQlMpCisgIHNldChCVUlMRF9TVEFUSUNfTElCUyBPTikKK2VuZGlmKCkKKworc2V0KExJ
Qk1BSk9SIDEpCitzZXQoTElCTUlOT1IgMCkKK3NldChMSUJQT0lOVCAxOSkKK3NldChMSUJWRVIg
IiR7TElCTUFKT1J9LiR7TElCTUlOT1J9LiR7TElCUE9JTlR9IikKKworZmlsZShHTE9CIGdzbV9N
QU4gbWFuLyouMSBtYW4vKi4zKQorc2V0KGdzbV9zcmMgc3JjL2FkZC5jIHNyYy9jb2RlLmMgc3Jj
L2RlY29kZS5jIHNyYy9nc21fY3JlYXRlLmMgc3JjL2dzbV9kZWNvZGUuYyBzcmMvZ3NtX2Rlc3Ry
b3kuYyBzcmMvZ3NtX2VuY29kZS5jIHNyYy9nc21fb3B0aW9uLmMgc3JjL2xvbmdfdGVybS5jIHNy
Yy9scGMuYyBzcmMvcHJlcHJvY2Vzcy5jIHNyYy9ycGUuYyBzcmMvc2hvcnRfdGVybS5jIHNyYy90
YWJsZS5jKQorCithZGRfZGVmaW5pdGlvbnMoLWFuc2kgLXBlZGFudGljIC1jIC1PMyAtRE5lZWRG
dW5jdGlvblByb3RvdHlwZXM9MSAtRFNBU1IgLURXQVY0OSkKK2FkZF9kZWZpbml0aW9ucygtV2Fs
bCAtV25vLWNvbW1lbnQgLVduby11bnVzZWQtY29uc3QtdmFyaWFibGUpCisKK2luY2x1ZGVfZGly
ZWN0b3JpZXMoJHtDTUFLRV9TT1VSQ0VfRElSfS9pbmMpCisKK2lmIChCVUlMRF9TSEFSRURfTElC
UykKKyAgYWRkX2xpYnJhcnkoZ3NtIFNIQVJFRCAke2dzbV9zcmN9KQorICBzZXQobGliX3Rhcmdl
dHMgZ3NtKQorICBzZXQoZ3NtX2xpbmsgUFVCTElDIGdzbSkKK2Vsc2UoKQorICBzZXQoZ3NtX2xp
bmsgUFJJVkFURSBnc20tc3RhdGljKQorZW5kaWYoKQorCitpZiAoQlVJTERfU1RBVElDX0xJQlMp
CisgIGFkZF9saWJyYXJ5KGdzbS1zdGF0aWMgU1RBVElDICR7Z3NtX3NyY30pCisgIHNldF90YXJn
ZXRfcHJvcGVydGllcyhnc20tc3RhdGljIFBST1BFUlRJRVMgT1VUUFVUX05BTUUgZ3NtKQorICBs
aXN0KEFQUEVORCBsaWJfdGFyZ2V0cyBnc20tc3RhdGljKQorZW5kaWYoKQorCitpbnN0YWxsKFRB
UkdFVFMgJHtsaWJfdGFyZ2V0c30KKyAgUlVOVElNRSBERVNUSU5BVElPTiBiaW4KKyAgQVJDSElW
RSBERVNUSU5BVElPTiBsaWIke0xJQl9TVUZGSVh9CisgIExJQlJBUlkgREVTVElOQVRJT04gbGli
JHtMSUJfU1VGRklYfSkKKworaW5zdGFsbChGSUxFUyBpbmMvZ3NtLmggREVTVElOQVRJT04gaW5j
bHVkZSkKK2luc3RhbGwoRklMRVMgQ09QWVJJR0hUIERFU1RJTkFUSU9OICR7Q01BS0VfSU5TVEFM
TF9QUkVGSVh9L3NoYXJlL2RvYy9saWJnc20pCisKK2lmKEJVSUxEX1RPT0xTKQorICBhZGRfZXhl
Y3V0YWJsZSh0b2FzdCBzcmMvdG9hc3QuYyBzcmMvdG9hc3RfbGluLmMgc3JjL3RvYXN0X3VsYXcu
YyBzcmMvdG9hc3RfYWxhdy5jIHNyYy90b2FzdF9hdWRpby5jKQorICB0YXJnZXRfbGlua19saWJy
YXJpZXModG9hc3QgJHtnc21fbGlua30pCisgIGluc3RhbGwoVEFSR0VUUyB0b2FzdCBERVNUSU5B
VElPTiBiaW4pCisgIGlmKFVOSVgpCisgICAgYWRkX2N1c3RvbV90YXJnZXQodW50b2FzdCBBTEwg
JHtDTUFLRV9DT01NQU5EfSAtRSBjcmVhdGVfc3ltbGluayB0b2FzdCB1bnRvYXN0IERFUEVORFMg
Z3NtIENPTU1FTlQgIkNyZWF0aW5nIHVudG9hc3Qgc3ltbGluayIpCisgICAgYWRkX2N1c3RvbV90
YXJnZXQodGNhdCBBTEwgJHtDTUFLRV9DT01NQU5EfSAtRSBjcmVhdGVfc3ltbGluayB0b2FzdCB0
Y2F0IERFUEVORFMgZ3NtIENPTU1FTlQgIkNyZWF0aW5nIHRjYXQgc3ltbGluayIpCisgICAgaW5z
dGFsbChGSUxFUyAke0NNQUtFX0NVUlJFTlRfQklOQVJZX0RJUn0vdW50b2FzdCBERVNUSU5BVElP
TiBiaW4pCisgICAgaW5zdGFsbChGSUxFUyAke0NNQUtFX0NVUlJFTlRfQklOQVJZX0RJUn0vdGNh
dCBERVNUSU5BVElPTiBiaW4pCisgIGVuZGlmKCkKK2VuZGlmKCkKKworaWYoQlVJTERfVEVTVFMp
CisgIHNldChnc21fdGVzdHMgY29kMmxpbiBjb2QydHh0IGdzbTJjb2QgbGluMmNvZCBsaW4ydHh0
KQorICBmb3JlYWNoKGdzbV90ZXN0ICR7Z3NtX3Rlc3RzfSkKKyAgICBhZGRfZXhlY3V0YWJsZSgk
e2dzbV90ZXN0fSB0c3QvJHtnc21fdGVzdH0uYykKKyAgICB0YXJnZXRfbGlua19saWJyYXJpZXMo
JHtnc21fdGVzdH0gJHtnc21fbGlua30pCisgIGVuZGZvcmVhY2goKQorICBpbnN0YWxsKFRBUkdF
VFMgJHtnc21fdGVzdHN9IERFU1RJTkFUSU9OIGJpbikKK2VuZGlmKCkKKworaWYoSU5TVEFMTF9N
QU4pCisgIGluc3RhbGwoRklMRVMgJHtnc21fTUFOfSBERVNUSU5BVElPTiAke0NNQUtFX0lOU1RB
TExfUFJFRklYfS9tYW4pCitlbmRpZigpCg==
XB64_PATCH

# cpu av8 av7 x86 x64
# NDK +++  .   .   .  clang
# GNU  .   .   .   .  gcc
# WIN  .   .   .   .  clang/gcc

# Filelist
# --------
# include/gsm.h
# lib/pkgconfig/libgsm.pc
# lib/libgsm.so
# lib/libgsm.a
# share/doc/libgsm/COPYRIGHT
# bin/toast
# bin/untoast
# bin/tcat
