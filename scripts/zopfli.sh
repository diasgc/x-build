#!/bin/bash

lib='zopfli'
dsc='Zopfli Compression Algorithm is a compression library programmed in C to perform very good, but slow, deflate or zlib compression.'
lic='Apache-2.0'
src='https://github.com/google/zopfli.git'
cfg='cmake'
eta='45'

cmake_static='BUILD_STATIC_LIBS'

pc_llibs="-lzopflipng -lzopfli"
pc_url="https://github.com/google/zopfli"

lst_inc='zopflipng_lib.h zopfli.h'
lst_lib='libzopflipng libzopfli'
lst_bin='zopflipng zopfli'
lst_lic='COPYING'
lst_pc='zopfli.pc'

dev_bra='main'
dev_vrs='zopfli-1.0.3'
stb_bra=''
stb_vrs=''

. xbuilder.sh

start

# patch 01 on CMakeLists.txt to support dual static shared builds
<<'XB64_PATCH'
LS0tIENNYWtlTGlzdHMudHh0CTIwMjItMDItMDEgMTI6NTk6MTMuMDYwMDU3MjAwICswMDAwCisrKyBDTWFrZUxpc3
RzLnR4dAkyMDIyLTAyLTAxIDEzOjAzOjEzLjM5MDA1NzIwMCArMDAwMApAQCAtMTQsMjggKzE0LDggQEAKICMgT3B0
aW9ucwogIwogCi0jIFpPUEZMSV9CVUlMRF9TSEFSRUQgY29udHJvbHMgaWYgWm9wZmxpIGxpYnJhcmllcyBhcmUgYn
VpbHQgYXMgc2hhcmVkIG9yCi0jIHN0YXRpYwotIwotIyBJdCBkZWZhdWx0cyB0byB0aGUgdmFsdWUgb2YgQlVJTERf
U0hBUkVEX0xJQlMgaWYgc2V0LCBhbmQgaW4gbW9zdCBjYXNlcwotIyB0aGF0IHNob3VsZCBiZSB1c2VkIGluc3RlYW
QuIFRoZSBwdXJwb3NlIG9mIFpPUEZMSV9CVUlMRF9TSEFSRUQgaXMgdG8gYWxsb3cKLSMgb3ZlcnJpZGluZyBpdCB3
aGVuIGJ1aWx0IGFzIGEgc3VicHJvamVjdC4KLXNldCh6b3BmbGlfc2hhcmVkX2RlZmF1bHQgT0ZGKQotaWYoREVGSU
5FRCBCVUlMRF9TSEFSRURfTElCUykKLSAgc2V0KHpvcGZsaV9zaGFyZWRfZGVmYXVsdCAke0JVSUxEX1NIQVJFRF9M
SUJTfSkKLWVuZGlmKCkKLW9wdGlvbihaT1BGTElfQlVJTERfU0hBUkVEICJCdWlsZCBab3BmbGkgd2l0aCBzaGFyZW
QgbGlicmFyaWVzIiAke3pvcGZsaV9zaGFyZWRfZGVmYXVsdH0pCi11bnNldCh6b3BmbGlfc2hhcmVkX2RlZmF1bHQp
Ci0KICMgWk9QRkxJX0JVSUxEX0lOU1RBTEwgY29udHJvbHMgaWYgWm9wZmxpIGFkZHMgYW4gaW5zdGFsbCB0YXJnZX
QgdG8gdGhlIGJ1aWxkCi0jCi0jIFdoZW4gYnVpbHQgc3RhbmRhbG9uZSBvciBhcyBhIHNoYXJlZCBsaWJyYXJ5IHN1
YnByb2plY3QsIHRoZSBkZWZhdWx0IGlzIE9OLAotIyBhbmQgZm9yIHN0YXRpYyBsaWJyYXJ5IHN1YnByb2plY3QgdG
hlIGRlZmF1bHQgaXMgT0ZGLgotaWYoem9wZmxpX3N0YW5kYWxvbmUgT1IgWk9QRkxJX0JVSUxEX1NIQVJFRCkKLSAg
b3B0aW9uKFpPUEZMSV9CVUlMRF9JTlNUQUxMICJBZGQgWm9wZmxpIGluc3RhbGwgdGFyZ2V0IiBPTikKLWVsc2UoKQ
otICBvcHRpb24oWk9QRkxJX0JVSUxEX0lOU1RBTEwgIkFkZCBab3BmbGkgaW5zdGFsbCB0YXJnZXQiIE9GRikKLWVu
ZGlmKCkKK29wdGlvbihaT1BGTElfQlVJTERfSU5TVEFMTCAiQWRkIFpvcGZsaSBpbnN0YWxsIHRhcmdldCIgT04pCi
AKICMgWk9QRkxJX0RFRkFVTFRfUkVMRUFTRSBlbmFibGVzIGNoYW5naW5nIGVtcHR5IGJ1aWxkIHR5cGUgdG8gUmVs
ZWFzZQogIwpAQCAtNjAsMTggKzQwLDkgQEAKIHNldChaT1BGTElfVkVSU0lPTl9QQVRDSCAzKQogc2V0KFpPUEZMSV
9WRVJTSU9OICR7Wk9QRkxJX1ZFUlNJT05fTUFKT1J9LiR7Wk9QRkxJX1ZFUlNJT05fTUlOT1J9LiR7Wk9QRkxJX1ZF
UlNJT05fUEFUQ0h9KQogCi1pZihaT1BGTElfQlVJTERfU0hBUkVEKQotICBzZXQoem9wZmxpX2xpYnJhcnlfdHlwZS
BTSEFSRUQpCi1lbHNlKCkKLSAgc2V0KHpvcGZsaV9saWJyYXJ5X3R5cGUgU1RBVElDKQotZW5kaWYoKQotCiBpbmNs
dWRlKEdOVUluc3RhbGxEaXJzKQogCi0jCi0jIGxpYnpvcGZsaQotIwotYWRkX2xpYnJhcnkobGliem9wZmxpICR7em
9wZmxpX2xpYnJhcnlfdHlwZX0KK3NldChsaWJ6b3BmbGlfc3JjCiAgIHNyYy96b3BmbGkvYmxvY2tzcGxpdHRlci5j
CiAgIHNyYy96b3BmbGkvY2FjaGUuYwogICBzcmMvem9wZmxpL2RlZmxhdGUuYwpAQCAtODUsNDMgKzU2LDY5IEBACi
AgIHNyYy96b3BmbGkvemxpYl9jb250YWluZXIuYwogICBzcmMvem9wZmxpL3pvcGZsaV9saWIuYwogKQotdGFyZ2V0
X2luY2x1ZGVfZGlyZWN0b3JpZXMobGliem9wZmxpCi0gIElOVEVSRkFDRQotICAgICQ8QlVJTERfSU5URVJGQUNFOi
R7Q01BS0VfQ1VSUkVOVF9TT1VSQ0VfRElSfS9zcmMvem9wZmxpPgotICAgICQ8SU5TVEFMTF9JTlRFUkZBQ0U6JHtD
TUFLRV9JTlNUQUxMX0lOQ0xVREVESVJ9PgotKQotc2V0X3RhcmdldF9wcm9wZXJ0aWVzKGxpYnpvcGZsaSBQUk9QRV
JUSUVTCi0gIE9VVFBVVF9OQU1FIHpvcGZsaQotICBWRVJTSU9OICR7Wk9QRkxJX1ZFUlNJT059Ci0gIFNPVkVSU0lP
TiAke1pPUEZMSV9WRVJTSU9OX01BSk9SfQotKQotaWYoVU5JWCBBTkQgTk9UIChCRU9TIE9SIEhBSUtVKSkKLSAgdG
FyZ2V0X2xpbmtfbGlicmFyaWVzKGxpYnpvcGZsaSBtKQotZW5kaWYoKQogCi0jCi0jIGxpYnpvcGZsaXBuZwotIwot
YWRkX2xpYnJhcnkobGliem9wZmxpcG5nICR7em9wZmxpX2xpYnJhcnlfdHlwZX0KK3NldChsaWJ6b3BmbGlwbmdfc3
JjCiAgIHNyYy96b3BmbGlwbmcvem9wZmxpcG5nX2xpYi5jYwogICBzcmMvem9wZmxpcG5nL2xvZGVwbmcvbG9kZXBu
Zy5jcHAKICAgc3JjL3pvcGZsaXBuZy9sb2RlcG5nL2xvZGVwbmdfdXRpbC5jcHAKICkKLXRhcmdldF9saW5rX2xpYn
JhcmllcyhsaWJ6b3BmbGlwbmcgbGliem9wZmxpKQotdGFyZ2V0X2luY2x1ZGVfZGlyZWN0b3JpZXMobGliem9wZmxp
cG5nCi0gIElOVEVSRkFDRQotICAgICQ8QlVJTERfSU5URVJGQUNFOiR7Q01BS0VfQ1VSUkVOVF9TT1VSQ0VfRElSfS
9zcmMvem9wZmxpcG5nPgotICAgICQ8SU5TVEFMTF9JTlRFUkZBQ0U6JHtDTUFLRV9JTlNUQUxMX0lOQ0xVREVESVJ9
PgotKQotc2V0X3RhcmdldF9wcm9wZXJ0aWVzKGxpYnpvcGZsaXBuZyBQUk9QRVJUSUVTCi0gIE9VVFBVVF9OQU1FIH
pvcGZsaXBuZwotICBWRVJTSU9OICR7Wk9QRkxJX1ZFUlNJT059Ci0gIFNPVkVSU0lPTiAke1pPUEZMSV9WRVJTSU9O
X01BSk9SfQotKQorCitzZXQobGliem9wZmxpX3RhcmdldHMgbGliem9wZmxpKQorc2V0KGxpYnpvcGZsaXBuZ190YX
JnZXRzIGxpYnpvcGZsaXBuZykKK2lmKEJVSUxEX1NIQVJFRF9MSUJTIEFORCBCVUlMRF9TVEFUSUNfTElCUykKKyAg
ICBsaXN0KEFQUEVORCBsaWJ6b3BmbGlfdGFyZ2V0cyBsaWJ6b3BmbGktc3RhdGljKQorICAgIGxpc3QoQVBQRU5EIG
xpYnpvcGZsaXBuZ190YXJnZXRzIGxpYnpvcGZsaXBuZy1zdGF0aWMpCitlbmRpZigpCisKK2ZvcmVhY2gobGliICR7
bGliem9wZmxpX3RhcmdldHN9KQorICAgIGlmKCR7bGlifSBNQVRDSEVTICItc3RhdGljJCIpCisgICAgICAgIHNldC
hidHlwZSBTVEFUSUMpCisgICAgICAgIHNldChzdHlwZSAiLXN0YXRpYyIpCisgICAgZWxzZSgpCisgICAgICAgIHNl
dChidHlwZSAiIikKKyAgICAgICAgc2V0KHN0eXBlICIiKQorICAgIGVuZGlmKCkKKyAgICBhZGRfbGlicmFyeSgke2
xpYn0gJHtidHlwZX0gJHtsaWJ6b3BmbGlfc3JjfSkKKyAgICB0YXJnZXRfaW5jbHVkZV9kaXJlY3Rvcmllcygke2xp
Yn0KKyAgICAgICAgSU5URVJGQUNFCisgICAgICAgICQ8QlVJTERfSU5URVJGQUNFOiR7Q01BS0VfQ1VSUkVOVF9TT1
VSQ0VfRElSfS9zcmMvem9wZmxpPgorICAgICAgICAkPElOU1RBTExfSU5URVJGQUNFOiR7Q01BS0VfSU5TVEFMTF9J
TkNMVURFRElSfT4KKyAgICApCisgICAgc2V0X3RhcmdldF9wcm9wZXJ0aWVzKCR7bGlifSBQUk9QRVJUSUVTCisgIC
AgICAgIE9VVFBVVF9OQU1FIHpvcGZsaQorICAgICAgICBWRVJTSU9OICR7Wk9QRkxJX1ZFUlNJT059CisgICAgICAg
IFNPVkVSU0lPTiAke1pPUEZMSV9WRVJTSU9OX01BSk9SfQorICAgICkKKyAgICBpZihVTklYIEFORCBOT1QgKEJFT1
MgT1IgSEFJS1UpKQorICAgICAgICB0YXJnZXRfbGlua19saWJyYXJpZXMoJHtsaWJ9IG0pCisgICAgZW5kaWYoKQor
ZW5kZm9yZWFjaCgpCisKK2ZvcmVhY2gobGliICR7bGliem9wZmxpcG5nX3RhcmdldHN9KQorICAgIGlmKCR7bGlifS
BNQVRDSEVTICItc3RhdGljJCIpCisgICAgICAgIHNldChidHlwZSBTVEFUSUMpCisgICAgICAgIHNldChzdHlwZSAi
LXN0YXRpYyIpCisgICAgZWxzZSgpCisgICAgICAgIHNldChidHlwZSAiIikKKyAgICAgICAgc2V0KHN0eXBlICIiKQ
orICAgIGVuZGlmKCkKKyAgICBhZGRfbGlicmFyeSgke2xpYn0gJHtidHlwZX0gJHtsaWJ6b3BmbGlwbmdfc3JjfSkK
KyAgICB0YXJnZXRfbGlua19saWJyYXJpZXMoJHtsaWJ9IGxpYnpvcGZsaSR7c3R5cGV9KQorICAgIHRhcmdldF9pbm
NsdWRlX2RpcmVjdG9yaWVzKCR7bGlifQorICAgICAgICBJTlRFUkZBQ0UKKyAgICAgICAgJDxCVUlMRF9JTlRFUkZB
Q0U6JHtDTUFLRV9DVVJSRU5UX1NPVVJDRV9ESVJ9L3NyYy96b3BmbGlwbmc+CisgICAgICAgICQ8SU5TVEFMTF9JTl
RFUkZBQ0U6JHtDTUFLRV9JTlNUQUxMX0lOQ0xVREVESVJ9PgorICAgICkKKyAgICBzZXRfdGFyZ2V0X3Byb3BlcnRp
ZXMoJHtsaWJ9IFBST1BFUlRJRVMKKyAgICAgICAgT1VUUFVUX05BTUUgem9wZmxpcG5nCisgICAgICAgIFZFUlNJT0
4gJHtaT1BGTElfVkVSU0lPTn0KKyAgICAgICAgU09WRVJTSU9OICR7Wk9QRkxJX1ZFUlNJT05fTUFKT1J9CisgICAg
ICAgICkKK2VuZGZvcmVhY2goKQogCiAjIE1TVkMgZG9lcyBub3QgZXhwb3J0IHN5bWJvbHMgYnkgZGVmYXVsdCB3aG
VuIGJ1aWxkaW5nIGEgRExMLCB0aGlzIGlzIGEKICMgd29ya2Fyb3VuZCBmb3IgcmVjZW50IHZlcnNpb25zIG9mIENN
YWtlCi1pZihNU1ZDIEFORCBaT1BGTElfQlVJTERfU0hBUkVEKQoraWYoTVNWQyBBTkQgQlVJTERfU0hBUkVEX0xJQl
MpCiAgIGlmKENNQUtFX1ZFUlNJT04gVkVSU0lPTl9MRVNTIDMuNCkKICAgICBtZXNzYWdlKFdBUk5JTkcgIkF1dG9t
YXRpYyBleHBvcnQgb2YgYWxsIHN5bWJvbHMgdG8gRExMIG5vdCBzdXBwb3J0ZWQgdW50aWwgQ01ha2UgMy40IikKIC
AgZWxzZSgpCkBAIC0xNjQsNyArMTYxLDcgQEAKICMKIGlmKFpPUEZMSV9CVUlMRF9JTlNUQUxMKQogICAjIEluc3Rh
bGwgYmluYXJpZXMsIGxpYnJhcmllcywgYW5kIGhlYWRlcnMKLSAgaW5zdGFsbChUQVJHRVRTIGxpYnpvcGZsaSBsaW
J6b3BmbGlwbmcgem9wZmxpIHpvcGZsaXBuZworICBpbnN0YWxsKFRBUkdFVFMgJHtsaWJ6b3BmbGlfdGFyZ2V0c30g
JHtsaWJ6b3BmbGlwbmdfdGFyZ2V0c30gem9wZmxpIHpvcGZsaXBuZwogICAgIEVYUE9SVCBab3BmbGlUYXJnZXRzCi
AgICAgUlVOVElNRSBERVNUSU5BVElPTiAke0NNQUtFX0lOU1RBTExfQklORElSfQogICAgIExJQlJBUlkgREVTVElO
QVRJT04gJHtDTUFLRV9JTlNUQUxMX0xJQkRJUn0KQEAgLTE5NCw0ICsxOTEsNCBAQAogICAgICAgREVTVElOQVRJT0
4gJHtDTUFLRV9JTlNUQUxMX0xJQkRJUn0vY21ha2UvWm9wZmxpCiAgICAgKQogICBlbmRpZigpCi1lbmRpZigpCitl
bmRpZigpClwgTm8gbmV3bGluZSBhdCBlbmQgb2YgZmlsZQo=
XB64_PATCH

# cpu av8 av7 x86 x64
# NDK +++  .   .   .  clang
# GNU  .   .   .   .  gcc
# WIN  .   .   .   .  clang/gcc

# Filelist
# --------
# include/zopflipng_lib.h
# include/zopfli.h
# lib/pkgconfig/zopflipng.pc
# lib/pkgconfig/zopfli.pc
# lib/libzopfli.a
# lib/cmake/Zopfli/ZopfliConfigVersion.cmake
# lib/cmake/Zopfli/ZopfliConfig.cmake
# lib/cmake/Zopfli/ZopfliConfig-release.cmake
# lib/libzopflipng.so
# lib/libzopfli.so
# lib/libzopflipng.a
# share/doc/zopfli/COPYING
# bin/zopflipng
# bin/zopfli
