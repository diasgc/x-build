#!/bin/bash

lib='vvdec'
pkg='libvvdec'
dsc='Fraunhofer Versatile Video Decoder (VVdeC)'
lic='LGPL-2.1'
src='https://github.com/fraunhoferhhi/vvdec.git'
cfg='cmake'
eta='480'
cmake_bin="BUILD_TOOLS"
cmake_static="BUILD_STATIC_LIBS"

lst_inc='vvenc/*.h'
lst_lib='libvvenc'
lst_bin='vvencapp vvencFFapp'
lst_lic='AUTHORS.md LICENSE.txt'
lst_pc='libvvenc.pc'

dev_bra='master'
dev_vrs='1.4.0'

. xbuild && start

# cpu av8 av7 x86 x64
# NDK +++  .   .   .  clang
# GNU  .   .   .   .  gcc
# WIN  .   .   .   .  clang/gcc

# Filelist
# --------
# share/doc/vvdec/LICENSE.txt
# share/doc/vvdec/AUTHORS.md
# lib/pkgconfig/libvvdec.pc
# lib/cmake/vvdec/vvdecTargets-shared-release.cmake
# lib/cmake/vvdec/vvdecTargets-shared.cmake
# lib/cmake/vvdec/vvdecConfigVersion.cmake
# lib/cmake/vvdec/vvdecConfig.cmake
# bin/vvdecapp
# lib/libvvdec.so
# include/vvdec/vvdecDecl.h
# include/vvdec/vvdec.h
# include/vvdec/sei.h
# include/vvdec/version.h
# lib/libvvdec.a
# 

# Patch 01 on source/Lib/vvdec/CMakeLists.txt and
# Patch 02 on cmake/modules/vvdecInstall.cmake to support dual static/shared build
# Patch 03 on source/Lib/vvdec/vvdecimpl.cpp to fix malloc_trim(0) error on android
<<'XB64_PATCH'
LS0tIHNvdXJjZS9MaWIvdnZkZWMvQ01ha2VMaXN0cy50eHQJMjAyMi0wMi0yNSAxNzo0NjoxMi4w
NTYyOTE0MDAgKzAwMDAKKysrIHNvdXJjZS9MaWIvdnZkZWMvQ01ha2VMaXN0cy50eHQJMjAyMi0w
Mi0yNSAxNzo0Mzo1OC44MDYyOTE0MDAgKzAwMDAKQEAgLTEwNSwyNSArMTA1LDMwIEBACiBpZigg
TVNWQyApCiAgIHNldCggUkVTT1VSQ0VfRklMRSAke0xJQl9OQU1FfS5yYyApCiBlbmRpZigpCitm
dW5jdGlvbihhZGRfbGliIHNmeCBsaW5rKQorICBhZGRfbGlicmFyeSggJHtMSUJfTkFNRX0ke3Nm
eH0gJHtsaW5rfSAke1NSQ19GSUxFU30gJHtJTkNfRklMRVN9ICR7TkFUVklTX0ZJTEVTfSAke1JF
U09VUkNFX0ZJTEV9ICkKIAotYWRkX2xpYnJhcnkoICR7TElCX05BTUV9ICR7U1JDX0ZJTEVTfSAk
e0lOQ19GSUxFU30gJHtOQVRWSVNfRklMRVN9ICR7UkVTT1VSQ0VfRklMRX0gKQotCi10YXJnZXRf
Y29tcGlsZV9kZWZpbml0aW9ucyggJHtMSUJfTkFNRX0gUFJJVkFURSAke0xJQl9OQU1FX1VDfV9T
T1VSQ0UgKQotdGFyZ2V0X2NvbXBpbGVfZGVmaW5pdGlvbnMoICR7TElCX05BTUV9IFBVQkxJQyAk
PCQ8QU5EOiQ8UExBVEZPUk1fSUQ6V2luZG93cz4sJDxTVFJFUVVBTDokPFRBUkdFVF9QUk9QRVJU
WToke0xJQl9OQU1FfSxUWVBFPixTSEFSRURfTElCUkFSWT4+OiR7TElCX05BTUVfVUN9X0RZTl9M
SU5LPiApCi0KLXRhcmdldF9jb21waWxlX29wdGlvbnMoICR7TElCX05BTUV9IFBSSVZBVEUgJDwk
PE9SOiQ8Q1hYX0NPTVBJTEVSX0lEOkNsYW5nPiwkPENYWF9DT01QSUxFUl9JRDpBcHBsZUNsYW5n
Pj46LVdhbGwgLVdlcnJvciAtV25vLXVudXNlZC1mdW5jdGlvbiAtV25vLWVudW0tY29tcGFyZS1z
d2l0Y2ggLVduby11bmtub3duLWF0dHJpYnV0ZXM+Ci0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICQ8JDxDWFhfQ09NUElMRVJfSUQ6R05VPjotV2FsbCAtV2Vycm9y
IC1Xbm8tdW51c2VkLWZ1bmN0aW9uIC1Xbm8tc2lnbi1jb21wYXJlIC1mZGlhZ25vc3RpY3Mtc2hv
dy1vcHRpb24gLVduby1pZ25vcmVkLWF0dHJpYnV0ZXM+Ci0gICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICQ8JDxDWFhfQ09NUElMRVJfSUQ6TVNWQz46L1c0IC9XWCAv
d2Q0MTAwIC93ZDQxMjcgL3dkNDI0NCAvd2Q0MjQ1IC93ZDQzODkgL3dkNDQ1NiAvd2Q0NDU3IC93
ZDQ0NTggL3dkNDQ1OSAvd2Q0NTA1IC93ZDQ3MDEgL3dkNDcwMiAvd2Q0NzAzID4pCi0KLXRhcmdl
dF9pbmNsdWRlX2RpcmVjdG9yaWVzKCAke0xJQl9OQU1FfSBQUklWQVRFICAgICAgICAgICAkPEJV
SUxEX0lOVEVSRkFDRToke0NNQUtFX0NVUlJFTlRfU09VUkNFX0RJUn0vLi4vLi4vLi4vaW5jbHVk
ZT4gJDxCVUlMRF9JTlRFUkZBQ0U6JHtDTUFLRV9CSU5BUllfRElSfT4KLSAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBTWVNURU0gSU5URVJGQUNFICAkPEJVSUxEX0lOVEVS
RkFDRToke0NNQUtFX0NVUlJFTlRfU09VUkNFX0RJUn0vLi4vLi4vLi4vaW5jbHVkZT4gJDxCVUlM
RF9JTlRFUkZBQ0U6JHtDTUFLRV9CSU5BUllfRElSfT4gKQotdGFyZ2V0X2luY2x1ZGVfZGlyZWN0
b3JpZXMoICR7TElCX05BTUV9IFBSSVZBVEUgLiAuLiAuLi9EZWNvZGVyTGliIC4uL0NvbW1vbkxp
YiAuLi9Db21tb25MaWIveDg2IC4uL2xpYm1kNSApCi0KLXRhcmdldF9pbmNsdWRlX2RpcmVjdG9y
aWVzKCAke0xJQl9OQU1FfSBTWVNURU0gUFJJVkFURSAuLi8uLi8uLi90aGlyZHBhcnR5ICkKLQot
dGFyZ2V0X2xpbmtfbGlicmFyaWVzKCAke0xJQl9OQU1FfSAke0lOVEVMX0lUVF9MSU5LX1RBUkdF
VH0gVGhyZWFkczo6VGhyZWFkcyApCi0KLSMgc2V0IHRoZSBmb2xkZXIgd2hlcmUgdG8gcGxhY2Ug
dGhlIHByb2plY3RzCi1zZXRfdGFyZ2V0X3Byb3BlcnRpZXMoICR7TElCX05BTUV9IFBST1BFUlRJ
RVMgRk9MREVSIGxpYiApCi0KLQorICB0YXJnZXRfY29tcGlsZV9kZWZpbml0aW9ucyggJHtMSUJf
TkFNRX0ke3NmeH0gUFJJVkFURSAke0xJQl9OQU1FX1VDfV9TT1VSQ0UgKQorICB0YXJnZXRfY29t
cGlsZV9kZWZpbml0aW9ucyggJHtMSUJfTkFNRX0ke3NmeH0gUFVCTElDICQ8JDxBTkQ6JDxQTEFU
Rk9STV9JRDpXaW5kb3dzPiwkPFNUUkVRVUFMOiQ8VEFSR0VUX1BST1BFUlRZOiR7TElCX05BTUV9
LFRZUEU+LFNIQVJFRF9MSUJSQVJZPj46JHtMSUJfTkFNRV9VQ31fRFlOX0xJTks+ICkKKyAgc2V0
X3RhcmdldF9wcm9wZXJ0aWVzKCAke0xJQl9OQU1FfSR7c2Z4fSBQUk9QRVJUSUVTIE9VVFBVVF9O
QU1FICR7TElCX05BTUV9KQorICB0YXJnZXRfY29tcGlsZV9vcHRpb25zKCAke0xJQl9OQU1FfSR7
c2Z4fSBQUklWQVRFICQ8JDxPUjokPENYWF9DT01QSUxFUl9JRDpDbGFuZz4sJDxDWFhfQ09NUElM
RVJfSUQ6QXBwbGVDbGFuZz4+Oi1XYWxsIC1Xbm8tZXJyb3IgLVduby11bnVzZWQtZnVuY3Rpb24g
LVduby1lbnVtLWNvbXBhcmUtc3dpdGNoIC1Xbm8tdW5rbm93bi1hdHRyaWJ1dGVzPgorICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQ8JDxDWFhfQ09NUElMRVJf
SUQ6R05VPjotV2FsbCAtV25vLWVycm9yIC1Xbm8tdW51c2VkLWZ1bmN0aW9uIC1Xbm8tc2lnbi1j
b21wYXJlIC1mZGlhZ25vc3RpY3Mtc2hvdy1vcHRpb24gLVduby1pZ25vcmVkLWF0dHJpYnV0ZXM+
CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJDwkPENYWF9D
T01QSUxFUl9JRDpNU1ZDPjovVzQgL1dYIC93ZDQxMDAgL3dkNDEyNyAvd2Q0MjQ0IC93ZDQyNDUg
L3dkNDM4OSAvd2Q0NDU2IC93ZDQ0NTcgL3dkNDQ1OCAvd2Q0NDU5IC93ZDQ1MDUgL3dkNDcwMSAv
d2Q0NzAyIC93ZDQ3MDMgPikKKworICB0YXJnZXRfaW5jbHVkZV9kaXJlY3RvcmllcyggJHtMSUJf
TkFNRX0ke3NmeH0gUFJJVkFURSAgICAgICAgICAgJDxCVUlMRF9JTlRFUkZBQ0U6JHtDTUFLRV9D
VVJSRU5UX1NPVVJDRV9ESVJ9Ly4uLy4uLy4uL2luY2x1ZGU+ICQ8QlVJTERfSU5URVJGQUNFOiR7
Q01BS0VfQklOQVJZX0RJUn0+CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICBTWVNURU0gSU5URVJGQUNFICAkPEJVSUxEX0lOVEVSRkFDRToke0NNQUtFX0NVUlJFTlRf
U09VUkNFX0RJUn0vLi4vLi4vLi4vaW5jbHVkZT4gJDxCVUlMRF9JTlRFUkZBQ0U6JHtDTUFLRV9C
SU5BUllfRElSfT4gKQorICB0YXJnZXRfaW5jbHVkZV9kaXJlY3RvcmllcyggJHtMSUJfTkFNRX0k
e3NmeH0gUFJJVkFURSAuIC4uIC4uL0RlY29kZXJMaWIgLi4vQ29tbW9uTGliIC4uL0NvbW1vbkxp
Yi94ODYgLi4vbGlibWQ1ICkKKworICB0YXJnZXRfaW5jbHVkZV9kaXJlY3RvcmllcyggJHtMSUJf
TkFNRX0ke3NmeH0gU1lTVEVNIFBSSVZBVEUgLi4vLi4vLi4vdGhpcmRwYXJ0eSApCisKKyAgdGFy
Z2V0X2xpbmtfbGlicmFyaWVzKCAke0xJQl9OQU1FfSR7c2Z4fSAke0lOVEVMX0lUVF9MSU5LX1RB
UkdFVH0gVGhyZWFkczo6VGhyZWFkcyApCisKKyAgIyBzZXQgdGhlIGZvbGRlciB3aGVyZSB0byBw
bGFjZSB0aGUgcHJvamVjdHMKKyAgc2V0X3RhcmdldF9wcm9wZXJ0aWVzKCAke0xJQl9OQU1FfSR7
c2Z4fSBQUk9QRVJUSUVTIEZPTERFUiBsaWIgKSAgCitlbmRmdW5jdGlvbigpCisKK2FkZF9saWIo
IiIgIiIpCitpZihCVUlMRF9TVEFUSUNfTElCUyBBTkQgQlVJTERfU0hBUkVEX0xJQlMpCisgIGFk
ZF9saWIoIi1zdGF0aWMiIFNUQVRJQykKKyAgaW5zdGFsbChUQVJHRVRTICR7TElCX05BTUV9LXN0
YXRpYyBERVNUSU5BVElPTiAke0NNQUtFX0lOU1RBTExfTElCRElSfSkKK2VuZGlmKCkKCi0tLSBj
bWFrZS9tb2R1bGVzL3Z2ZGVjSW5zdGFsbC5jbWFrZQkyMDIyLTAyLTI1IDE3OjM1OjAxLjQ0NjI5
MTQwMCArMDAwMAorKysgY21ha2UvbW9kdWxlcy92dmRlY0luc3RhbGwuY21ha2UJMjAyMi0wMi0y
NSAxNzowNzozNy4zODYyOTE0MDAgKzAwMDAKQEAgLTY0LDIxICs2NCwxOCBAQAogaW5zdGFsbCgg
RklMRVMgY21ha2UvaW5zdGFsbC92dmRlY0NvbmZpZy5jbWFrZSAgICAgICAgICAgICAgICAgICAg
ICAgREVTVElOQVRJT04gJHtDTUFLRV9JTlNUQUxMX0xJQkRJUn0vY21ha2UvdnZkZWMgKQogaW5z
dGFsbCggRklMRVMgJHtDTUFLRV9DVVJSRU5UX0JJTkFSWV9ESVJ9L3Z2ZGVjQ29uZmlnVmVyc2lv
bi5jbWFrZSAgREVTVElOQVRJT04gJHtDTUFLRV9JTlNUQUxMX0xJQkRJUn0vY21ha2UvdnZkZWMg
KQogCi1mdW5jdGlvbihpbnN0YWxsX2NvbmZpZyBDT05GSUdfUE9TVEZJWCkKLSAgIyBjcmVhdGUg
dGFyZ2V0IGNtYWtlIGZpbGVzCi0gIGluc3RhbGwoIEVYUE9SVCB2dmRlY1RhcmdldHMtcmVsZWFz
ZSAgICAgICAgTkFNRVNQQUNFIHZ2ZGVjOjogRklMRSB2dmRlY1RhcmdldHMtJHtDT05GSUdfUE9T
VEZJWH0uY21ha2UgQ09ORklHVVJBVElPTlMgUmVsZWFzZSAgICAgICAgREVTVElOQVRJT04gJHtD
TUFLRV9JTlNUQUxMX0xJQkRJUn0vY21ha2UvdnZkZWMgKQotICBpbnN0YWxsKCBFWFBPUlQgdnZk
ZWNUYXJnZXRzLWRlYnVnICAgICAgICAgIE5BTUVTUEFDRSB2dmRlYzo6IEZJTEUgdnZkZWNUYXJn
ZXRzLSR7Q09ORklHX1BPU1RGSVh9LmNtYWtlIENPTkZJR1VSQVRJT05TIERlYnVnICAgICAgICAg
IERFU1RJTkFUSU9OICR7Q01BS0VfSU5TVEFMTF9MSUJESVJ9L2NtYWtlL3Z2ZGVjICkKLSAgaW5z
dGFsbCggRVhQT1JUIHZ2ZGVjVGFyZ2V0cy1yZWx3aXRoZGViaW5mbyBOQU1FU1BBQ0UgdnZkZWM6
OiBGSUxFIHZ2ZGVjVGFyZ2V0cy0ke0NPTkZJR19QT1NURklYfS5jbWFrZSBDT05GSUdVUkFUSU9O
UyBSZWxXaXRoRGViSW5mbyBERVNUSU5BVElPTiAke0NNQUtFX0lOU1RBTExfTElCRElSfS9jbWFr
ZS92dmRlYyApICAKLWVuZGZ1bmN0aW9uKGluc3RhbGxfY29uZmlnKQotCiAjIHNldCBjb25maWcg
cG9zdGZpeAotaWYoTk9UIEJVSUxEX1NIQVJFRF9MSUJTIE9SIEJVSUxEX1NUQVRJQ19MSUJTKQot
ICBpbnN0YWxsX2NvbmZpZyhzdGF0aWMpCi1lbmRpZigpCi1pZihCVUlMRF9TSEFSRURfTElCUykK
LSAgaW5zdGFsbF9jb25maWcoc2hhcmVkKQoraWYoIEJVSUxEX1NIQVJFRF9MSUJTICkKKyAgc2V0
KCBDT05GSUdfUE9TVEZJWCBzaGFyZWQgKQorZWxzZSgpCisgIHNldCggQ09ORklHX1BPU1RGSVgg
c3RhdGljICkKIGVuZGlmKCkKIAorIyBjcmVhdGUgdGFyZ2V0IGNtYWtlIGZpbGVzCitpbnN0YWxs
KCBFWFBPUlQgdnZkZWNUYXJnZXRzLXJlbGVhc2UgICAgICAgIE5BTUVTUEFDRSB2dmRlYzo6IEZJ
TEUgdnZkZWNUYXJnZXRzLSR7Q09ORklHX1BPU1RGSVh9LmNtYWtlIENPTkZJR1VSQVRJT05TIFJl
bGVhc2UgICAgICAgIERFU1RJTkFUSU9OICR7Q01BS0VfSU5TVEFMTF9MSUJESVJ9L2NtYWtlL3Z2
ZGVjICkKK2luc3RhbGwoIEVYUE9SVCB2dmRlY1RhcmdldHMtZGVidWcgICAgICAgICAgTkFNRVNQ
QUNFIHZ2ZGVjOjogRklMRSB2dmRlY1RhcmdldHMtJHtDT05GSUdfUE9TVEZJWH0uY21ha2UgQ09O
RklHVVJBVElPTlMgRGVidWcgICAgICAgICAgREVTVElOQVRJT04gJHtDTUFLRV9JTlNUQUxMX0xJ
QkRJUn0vY21ha2UvdnZkZWMgKQoraW5zdGFsbCggRVhQT1JUIHZ2ZGVjVGFyZ2V0cy1yZWx3aXRo
ZGViaW5mbyBOQU1FU1BBQ0UgdnZkZWM6OiBGSUxFIHZ2ZGVjVGFyZ2V0cy0ke0NPTkZJR19QT1NU
RklYfS5jbWFrZSBDT05GSUdVUkFUSU9OUyBSZWxXaXRoRGViSW5mbyBERVNUSU5BVElPTiAke0NN
QUtFX0lOU1RBTExfTElCRElSfS9jbWFrZS92dmRlYyApCisKIGNvbmZpZ3VyZV9maWxlKCBwa2dj
b25maWcvbGlidnZkZWMucGMuaW4gJHtDTUFLRV9DVVJSRU5UX0JJTkFSWV9ESVJ9L3BrZ2NvbmZp
Zy9saWJ2dmRlYy5wYyBAT05MWSApCiBpbnN0YWxsKCBGSUxFUyAke0NNQUtFX0NVUlJFTlRfQklO
QVJZX0RJUn0vcGtnY29uZmlnL2xpYnZ2ZGVjLnBjIERFU1RJTkFUSU9OICR7Q01BS0VfSU5TVEFM
TF9MSUJESVJ9L3BrZ2NvbmZpZyApCiAKCi0tLSBzb3VyY2UvTGliL3Z2ZGVjL3Z2ZGVjaW1wbC5j
cHAJMjAyMS0xMC0wOCAxNTo1MDo1OC41NDIwMDAwMDAgKzAxMDAKKysrIHNvdXJjZS9MaWIvdnZk
ZWMvdnZkZWNpbXBsLmNwcAkyMDIxLTEwLTA4IDE1OjUxOjI4LjE5MDAwMDAwMCArMDEwMApAQCAt
MTkwLDcgKzE5MCw3IEBACiAgIGRlbGV0ZSBtX2NEZWNMaWI7CiAgIGRlc3Ryb3lST00oKTsKIAot
I2lmIGRlZmluZWQoIF9fbGludXhfXyApCisjaWYgZGVmaW5lZCggX19saW51eF9fICkgJiYgIWRl
ZmluZWQoX19BTkRST0lEX18pCiAgIG1hbGxvY190cmltKDApOwogI2VuZGlmCg==
XB64_PATCH


